var loopStop=0;Browser.webkit=Browser.safari||Browser.chrome;Object.extend("set",function(a,c){var b={};b[a]=c;return b});var MooRTE=new Class({Implements:[Options],options:{floating:true,padFloat:true,where:"before",stretch:false,location:"elements",buttons:"div.Menu:[Main,File,Insert]",skin:"Word03",elements:"textarea, .rte"},initialize:function(c){this.setOptions(c);var e,b=this,d=$$(this.options.elements),a=this.options.location.substr(4,1).toLowerCase();if(!MooRTE.activeField){MooRTE.extend({ranges:{},btnVals:[],activeField:"",activeBar:""})}if(!Browser.ie){MooRTE.btnVals.push("unselectable")}d.each(function(g,f){if("textarea,input".contains(g.get("tag"),",")){d[f]=g=b.textArea(g)}if(a=="e"||!e){e=b.insertToolbar(a)}if("bt".contains(a)){g.set("contentEditable",true)}else{a=="e"?b.positionToolbar(g,e):MooRTE.Utilities.addEvents(g.set("contentEditable",true),{focus:function(){b.positionToolbar(g,e)},blur:function(){this.setStyle("padding-top",this.getStyle("padding-top").slice(0,-2)-e.getFirst().getSize().y).removeClass("rteShow");e.addClass("rteHide")}})}g.store("bar",e);MooRTE.Utilities.addEvents(g,{keydown:MooRTE.Utilities.shortcuts,keyup:MooRTE.Utilities.updateBtns,mouseup:MooRTE.Utilities.updateBtns,focus:function(){MooRTE.activeField=this;MooRTE.activeBar=e}});MooRTE.Utilities.addEvents(e,{mouseup:MooRTE.Utilities.updateBtns})});e.store("fields",d);MooRTE.activeField=d[0];MooRTE.activeBar=MooRTE.activeField.retrieve("bar");if(a=="t"){e.addClass("rtePageTop").getFirst().addClass("rteTopDown")}else{if(a=="b"){e.addClass("rtePageBottom")}}if(Browser.firefox){MooRTE.Utilities.exec("styleWithCSS")}},insertToolbar:function(c){var a=this;var b=new Element("div",{"class":"rteRemove MooRTE "+(!c||c=="n"?"rteHide":""),contentEditable:false}).adopt(new Element("div",{"class":"RTE "+a.options.skin})).inject(document.body);MooRTE.activeBar=b;MooRTE.Utilities.addElements(this.options.buttons,[b.getFirst(),"bottom"]);return b},positionToolbar:function(c,b){c.set("contentEditable",true).addClass("rteShow");var f=this.options,a=c.getCoordinates(),g=c.addClass("rte"+(f.stretch?"":"No")+"Stretch").getStyle("border-width").match(/(\d)/g),d=b.removeClass("rteHide").setStyle("width",a.width-(f.floating?0:g[1]*1+g[3]*1)).getFirst().getCoordinates().height;if(f.floating){var e={before:"margin-top",after:"margin-after",top:"padding-top",bottom:"padding-bottom"}[f.where];c.setStyle(e,parseInt(c.getStyle(e))+d);if(!f.padFloat){c.setStyle("min-height",a.height-d).setStyle("height",a.height-d)}b.setStyles({left:a.left,top:(a.top-d>0?a.top:a.bottom)}).addClass("rteFloat").getFirst().addClass("rteFloat")}else{c.setStyle("padding-top",c.getStyle("padding-top").slice(0,-2)*1+d).grab(b,"top")}},textArea:function(a){var c=new Element("div",{text:a.get("value"),"class":"rteTextArea "+a.get("class"),styles:{width:a.getSize().x}}).setStyle(Browser.ie?"height":"min-height",a.getSize().y).store("src",a).replaces(a);a.store("new",c);var b=a.getParent("form");if(b){MooRTE.Utilities.addEvents(b,{submit:function(){a.set("value",MooRTE.Utilities.clean(c)).replaces(c)}})}return c}});MooRTE.Range={create:function(a){var b=window.document.selection||window.getSelection();if(!b){return null}return MooRTE.ranges[a||"a1"]=b.getRangeAt?b.getRangeAt(0):b.createRange()},get:function(c,a){if(!a){a=MooRTE.Range.create()}switch(c){case"text":return a.text||a.toString();case"node":return a.cloneContents?a.cloneContents():new Element("div",{html:a.htmlText});default:case"html":var d=a.htmlText;if(!d){var b=a.cloneContents();MooRTE.Range.content.empty().appendChild(b);d=MooRTE.Range.content.innerHTML}return d}},set:function(a){a=MooRTE.ranges[a||"a1"];if(a.select){a.select()}else{var b=window.getSelection();b.removeAllRanges();b.addRange(a)}return MooRTE.Range},insert:function(b,a){if(Browser.ie){if(!a){a=MooRTE.Range.create()}a.pasteHTML(b)}else{MooRTE.Utilities.exec("insertHTML",b)}return MooRTE.Range},wrap:function(c,b,a){if(!a){a=MooRTE.Range.create()}var d=new Element(c,b);try{Browser.ie?a.pasteHTML(d.set("html",a.htmlText).outerHTML):a.surroundContents(d)}catch(f){if(f.code==1){return false}}return d},wrapText:function(b,a){var e=a.getParent(".RTE").getElement("textarea");if(!(b.substr(0,1)=="<")){b='<span style="'+b+'">'}if(!Browser.ie){var f=e.selectionStart,d=new RegExp("(.{"+f+"})(.{"+(e.selectionEnd-f)+"})(.*)","m").exec(e.get("value")),c=b+d[2]+"</"+b.match(/^<(\w+)/)[1]+">";e.set("value",d[1]+c+d[3]).selectionEnd=f+c.length}else{var c=new Element(b||"span",{html:range.get()});range.pasteHTML(c)}return MooRTE.Range},replace:function(c,b){if(!b){b=MooRTE.Range.create()}if(Browser.ie){var d=document.uniqueID;b.pasteHTML("<span id='"+d+"'></span>");c.replaces(document.id(d))}else{MooRTE.Utilities.exec("inserthtml",c);return;b.deleteContents();if(b.startContainer.nodeType==3){var a=b.startContainer.splitText(b.startOffset);a.parentNode.insertBefore(c,a)}else{var a=b.startContainer.childNodes[b.startOffset];b.startContainer.insertBefore(c,a)}}},parent:function(a){if(!(a=a||MooRTE.Range.create())){return false}return Browser.ie?typeOf(a)=="object"?a.parentElement():a:a.commonAncestorContainer}};(function(){if(Browser.firefox){MooRTE.Range.selection=window.getSelection()}if(!Browser.ie){MooRTE.Range.content=new Element("div")}}());MooRTE.Tabs={};MooRTE.Utilities={exec:function(){var a=Array.from(arguments).flatten();document.execCommand(a[0],a[2]||null,a[1]||false)},shortcuts:function(d){if(d.key=="enter"){if(!Browser.ie){return}d.stop();return MooRTE.Range.insert("<br/>")}var c,b,a=MooRTE.activeBar.retrieve("shortcuts");if(d&&d.control&&a[d.key]){d.stop();b=MooRTE.activeBar.getElement(".rte"+a[d.key]);b.fireEvent("mousedown",b)}},updateBtns:function(a){var b,c=MooRTE.activeBar.retrieve("update");c.state.each(function(d){if(d[2]){d[2].call(d[1],d[0])}else{try{b=window.document.queryCommandState(d[0])}catch(f){b=false}d[1][(b?"add":"remove")+"Class"]("rteSelected")}});c.value.each(function(d){b=window.document.queryCommandValue(d[0]);if(b){d[2].call(d[1],d[0],b)}});c.custom.each(function(){vals[2].call(vals[1],vals[0])});if(Browser.firefox&&MooRTE.Range.selection.anchorNode.id=="rteMozFix"){MooRTE.Range.selection.extend(MooRTE.Range.selection.anchorNode.parentNode,0)}},addEvents:function(b,a){Object.append(b.retrieve("rteEvents",{}),a);b.addEvents(a)},removeEvents:function(b,a){Object.each(b.retrieve("rteEvents",{}),function(c,d){b.removeEvent(d,c)});if(a){b.eliminate("rteEvents")}},eventHandler:function(d,b,a){var c=MooRTE.Elements[a][d];switch(typeOf(c)){case"function":c.call(b,a,d);break;case"array":c=Array.clone(c).each(function(f){MooRTE.eventHandler(f,b,a)});break;case"object":Object.every(Object.clone(c),function(g,e){var f=Array.from(g).append([a,d]);MooRTE.Utilities[e].apply(b,f)});break;case"string":d=="source"&&d.substr(0,2)!="on"?MooRTE.Range.wrapText(c,b):MooRTE.Utilities.eventHandler(c,b,a)}},addElements:function(f,a,b){if(!MooRTE.btnVals.args){MooRTE.btnVals.combine(["args","shortcut","element","onClick","img","onLoad","source","contains"])}if(!a){a=MooRTE.activeBar.getFirst()}else{if(Type.isArray(a)){var e=a[1];a=a[0]}}if(!b){b={}}if(typeOf(f)=="string"){f=f.replace(/'([^']*)'|"([^"]*)"|([^{}:,\][\s]+)/gm,"'$1$2$3'");f=f.replace(/((?:[,[:]|^)\s*)('[^']+'\s*:\s*'[^']+'\s*(?=[\],}]))/gm,"$1{$2}");f=f.replace(/((?:[,[:]|^)\s*)('[^']+'\s*:\s*{[^{}]+})/gm,"$1{$2}");while(f!=(f=f.replace(/((?:[,[]|^)\s*)('[^']+'\s*:\s*\[(?:(?=([^\],\[]+))\3|\]}|[,[](?!\s*'[^']+'\s*:\s*\[([^\]]|\]})+\]))*\](?!}))/gm,"$1{$2}"))){}f=JSON.decode("["+f+"]")}var c=[],i=0;do{if(c.length){f=c,c=[]}Array.from(f).each(function(j){switch(typeOf(j)){case"string":c.push(j);break;case"object":Object.each(j,function(l,k){c.push(Object.set(k,l))});break;case"array":j.each(function(k){c.push(k)});i=j.length}})}while(i);var g=[],d=a.hasClass("MooRTE")?a:a.getParent(".MooRTE");c.each(function(m){if(Type.isObject(m)){var p=Object.values(m)[0];m=Object.keys(m)[0]}var k=".rte"+m.replace(".",".rte")+(b.className?"."+b.className.replace(" ","."):""),q={before:"Previous",after:"Next",top:"First"}[e]||"Last",r=a["get"+q](k),m=m.split(".")[0];if(!r||!b.ifExists){var o=0,n=MooRTE.Elements[m],u=(n.element&&n.element.toLowerCase()=="textarea"),t="text,password,submit,button,checkbox,file,hidden,image,radio,reset".contains(n.type),l="bold,italic,underline,strikethrough,subscript,superscript,unlink,insertorderedlist,insertunorderedlist".contains(m.toLowerCase(),",");var s=Object.append({href:"javascript:void(0)",unselectable:(t||u?"off":"on"),title:m+(n.shortcut?" (Ctrl+"+n.shortcut.capitalize()+")":""),styles:n.img?(isNaN(n.img)?{"background-image":"url("+n.img+")"}:{"background-position":"0 "+(-20*n.img)+"px"}):{},events:{mousedown:function(y){MooRTE.activeBar=d;var x=d.retrieve("source"),v=d.retrieve("fields");var w=MooRTE.Range.parent();if(Browser.webkit&&w.nodeType==3){w=w.parentElement}if(!(v.contains(MooRTE.activeField)&&MooRTE.activeField.contains(w))){(MooRTE.activeField=v[0]).focus()}if(y&&y.stop){t||u?y.stopPropagation():y.stop()}!n.onClick&&!x&&(!n.element||n.element=="a")?MooRTE.Utilities.exec(n.args||m):MooRTE.Utilities.eventHandler(x||"onClick",this,m)}}},n);MooRTE.btnVals[n.element?"include":"erase"]("href").each(function(v){delete s[v]});r=new Element((t&&!n.element?"input":n.element||"a")+k,s).inject(a,e);if(n.onUpdate||l){d.retrieve("update",{value:[],state:[],custom:[]})["fontname,fontsize,backcolor,forecolor,hilitecolor,justifyleft,justifyright,justifycenter".contains(m.toLowerCase(),",")?"value":(l?"state":"custom")].push([m,r,n.onUpdate])}if(n.shortcut){d.retrieve("shortcuts",{})[n.shortcut]=m}MooRTE.Utilities.eventHandler("onLoad",r,m)}var j=p||n&&n.contains;if(j&&!(b.ifExists=="stop"&&!n)){MooRTE.Utilities.addElements(j,r,b.inherit?b:{})}r.removeClass("rteHide");g.push(r)});return g[1]?g:g[0]},tabs:function(d,c,a,b){if(!c){c="tabs1"}MooRTE.btnVals.combine(["onExpand","onHide","onShow","onUpdate"]);Object.each(MooRTE.Tabs[c],function(f,g){f[0].removeClass("rteSelected");f[1].addClass("rteHide");MooRTE.Utilities.eventHandler("onHide",this,b)},this);this.addClass("rteSelected").addClass("rteGroupBtn_"+b);var e=MooRTE.Utilities.addElements(d,a,{className:"rteGroup_"+b,ifExists:"stop"});MooRTE.Utilities.eventHandler("onShow",this,b);if(!MooRTE.Tabs[c]){MooRTE.Tabs[c]={}}if(!MooRTE.Tabs[c][b]){MooRTE.Tabs[c][b]=[this,e]}},clipStickyWin:function(a){if(Browser.firefox||(Browser.webkit&&a=="paste")){if(window.AssetLoader){AssetLoader.javascript(["mootools-more.js","StickyWinModalUI.js"],{onComplete:function(c){var b="For your protection, "+(Browser.webkit?"Webkit":"Firefox")+" does not allow access to the clipboard.<br/>						<b>Please use Ctrl+C to copy, Ctrl+X to cut, and Ctrl+V to paste.</b><br/><br/>						If this functionality is important consider switching to Internet Explorer,<br/> which allows us to access [and modify] your system.";MooRTE.Elements.clipPop=new StickyWin.Modal({content:StickyWin.ui("Security Restriction",b,{buttons:[{text:"close"}]})});MooRTE.Elements.clipPop.hide()}})}}},fontsize:function(a,b){if(b==undefined){b=window.document.queryCommandValue("fontsize")||MooRTE.Range.parent().getStyle("font-size")}if(b==+b){b=+b+a}else{b=b.split(/([^\d]+)/)[0];[0,10,13,16,18,24,32,48].every(function(d,c){if(d<b){return true}b=!(d-b)||a<0?c+a:c})}MooRTE.Utilities.exec("fontsize",b)},clean:function(e,m){m=Object.append({xhtml:false,semantic:true,remove:""},m);var k="<br"+(a?"/":"")+">";var a=[[/(<(?:img|input)[^\/>]*)>/g,"$1 />"]];var i=[[/<li>\s*<div>(.+?)<\/div><\/li>/g,"<li>$1</li>"],[/<span style="font-weight: bold;">(.*)<\/span>/gi,"<strong>$1</strong>"],[/<span style="font-style: italic;">(.*)<\/span>/gi,"<em>$1</em>"],[/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>"],[/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>"],[/<u\b[^>]*>(.*?)<\/u[^>]*>/gi,'<span style="text-decoration: underline;">$1</span>'],[/<p>[\s\n]*(<(?:ul|ol)>.*?<\/(?:ul|ol)>)(.*?)<\/p>/ig,"$1<p>$2</p>"],[/<\/(ol|ul)>\s*(?!<(?:p|ol|ul|img).*?>)((?:<[^>]*>)?\w.*)$/g,"</$1><p>$2</p>"],[/<br[^>]*><\/p>/g,"</p>"],[/<p>\s*(<img[^>]+>)\s*<\/p>/ig,"$1\n"],[/<p([^>]*)>(.*?)<\/p>(?!\n)/g,"<p$1>$2</p>\n"],[/<\/(ul|ol|p)>(?!\n)/g,"</$1>\n"],[/><li>/g,">\n\t<li>"],[/([^\n])<\/(ol|ul)>/g,"$1\n</$2>"],[/([^\n])<img/ig,"$1\n<img"],[/^\s*$/g,""]];var j=[[/\s*<br ?\/?>\s*<\/p>/gi,"</p>"]];var l=[[/<br class\="webkit-block-placeholder">/gi,"<br />"],[/<span class="Apple-style-span">(.*)<\/span>/gi,"$1"],[/ class="Apple-style-span"/gi,""],[/<span style="">/gi,""],[/^([\w\s]+.*?)<div>/i,"<p>$1</p><div>"],[/<div>(.+?)<\/div>/ig,"<p>$1</p>"]];var b=[[/<br\s*\/?>/gi,k],[/><br\/?>/g,">"],[/^<br\/?>/g,""],[/<br\/?>$/g,""],[/<br\/?>\s*<\/(h1|h2|h3|h4|h5|h6|li|p)/gi,"</$1"],[/<p>\s*<br\/?>\s*<\/p>/gi,"<p>\u00a0</p>"],[/<p>(&nbsp;|\s)*<\/p>/gi,"<p>\u00a0</p>"],[/<p>\W*<\/p>/g,""],[/<\/p>\s*<\/p>/g,"</p>"],[/<[^> ]*/g,function(n){return n.toLowerCase()}],[/<[^>]*>/g,function(n){n=n.replace(/ [^=]+=/g,function(o){return o.toLowerCase()});return n}],[/<[^>]*>/g,function(n){n=n.replace(/( [^=]+=)([^"][^ >]*)/g,'$1"$2"');return n}]];var c=[[/<p>\s*<br ?\/?>\s*<\/p>/gi,"<p>\u00a0</p>"],[/<br>/gi,"<br />"],[/<br ?\/?>$/gi,""],[/^<br ?\/?>/gi,""],[/><br ?\/?>/gi,">"],[/<br ?\/?>\s*<\/(h1|h2|h3|h4|h5|h6|li|p)/gi,"</$1"],[/<p>(?:\s*)<p>/g,"<p>"]];var f;if(typeOf(e)=="element"){f=e;var g=f.retrieve("bar");if(f.contains(g)&&f!=g){f.moorte("remove")}}else{f=$("washer")||new Element("div",{id:"washer"}).inject(document.body)}f.getElements("p:empty"+(m.remove?","+m.remove:"")).destroy();if(!Browser.firefox){f.getElements("p>p:only-child").each(function(n){var o=n.getParent();if(o.childNodes.length==1){n.replaces(o)}})}e=f.get("html");if(f!=$("washer")){f.moorte()}if(a){b.append(a)}if(i){b.append(i)}if(Browser.webkit){b.append(l)}do{var d=e;b.each(function(n){e=e.replace(n[0],n[1])})}while(d!=e);return e.trim()}};MooRTE.extensions=function(){var c=Array.link(arguments,{options:Type.isObject,cmd:Type.isString,rte:Type.isElement}),a="detach,hide,remove,destroy".test(c.cmd,"i")?c.cmd.toLowerCase():"",b=Array.from(this);b.every(function(d,f){var g,e,d=b[f]=d.retrieve("new")||d;if(c.rte){g=c.rte.hasClass("MooRTE")?c.rte:c.rte.retrieve("bar");if(!g){return alert("Err 600: The passed in element is not connected to an RTE."),600}if(d.retrieve("bar")!=g){d.retrieve("bar").retrieve("fields").erase(d);d.store("bar",g);g.retrieve("fields").include(d)}}else{g=d.hasClass("MooRTE")?d:d.retrieve("bar")}if(!a){if(!g){new MooRTE(Object.merge(c.options||{},{elements:this}));b[f]=d.retrieve("new")||d;return false}else{if(g.hasClass("rteHide")){return g.removeClass("rteHide")}}}else{if(!g||d.retrieve("removed")||!d.getParent()){return true}}switch(a){case"hide":return g.addClass("rteHide");case"detach":if(d==g){return true}g.retrieve("fields").erase(d);e=[d];break;case"remove":if(g.retrieve("removed")){return true}g.store("removed",g.getPrevious()?[g.getPrevious(),"after"]:[g.getParent(),"top"]);g.dispose();e=g.retrieve("fields");break;case"destroy":e=g.retrieve("fields");g=g.destroy();break;default:e=[d],removed=g.retrieve("removed");if(removed){e=g.retrieve("fields");g.inject(removed[0],removed[1]).eliminate("removed")}else{if(d==g){return}}e.each(function(i){g.retrieve("fields").include(i);var j=i.retrieve("src");if(!j){i.set("contentEditable",true);MooRTE.Utilities.addEvents(i,i.retrieve("rteEvents"))}else{if(j.getParent()){i.set("html",j.get("value")).replaces(j)}}});return true}b[f]=d.retrieve("src")||d;e.each(function(i){if(Browser.firefox&&i.getElement("#rteMozFix")){i.getElement("#rteMozFix").destroy()}var j=i.retrieve("src");if(j){j.set("value",i.get("html")).replaces(i);if(!g){j.eliminate("new");i.destroy()}}else{i.set("contentEditable",false);MooRTE.Utilities.removeEvents(i,"destroy");if(!g){i.eliminate("bar")}}});return true}.bind(this));return b};Element.implement({moorte:MooRTE.extensions});Elements.implement({moorte:MooRTE.extensions});MooRTE.Groups={Main:"Toolbar:[start,bold,italic,underline,strikethrough,Justify,Lists,Indents,subscript,superscript]",File:{Toolbar:["start","save","cut","copy","paste","redo","undo","selectall","removeformat","viewSource"]},Font:{Toolbar:["start","fontsize","decreasefontsize","increasefontsize","backcolor","forecolor"]},Sert:{Toolbar:["start","inserthorizontalrule","blockquote","hyperlink"]}};MooRTE.Elements={Main:{text:"Main","class":"rteText",onLoad:{tabs:[MooRTE.Groups.Main,"tabs1",null]},onClick:"onLoad"},File:{text:"File","class":"rteText",onClick:{tabs:[MooRTE.Groups.File,"tabs1",null]}},Font:{text:"Font","class":"rteText",onClick:{tabs:[MooRTE.Groups.Font,"tabs1",null]}},Insert:{text:"Insert","class":"rteText",onClick:{tabs:[MooRTE.Groups.Sert,"tabs1",null]}},View:{text:"Views","class":"rteText",onClick:{tabs:{Toolbar:["start","Html/Text"]}}},Justify:{img:6,"class":"Flyout rteSelected",contains:"div.Flyout:[justifyleft,justifycenter,justifyright,justifyfull]"},Lists:{img:14,"class":"Flyout",contains:"div.Flyout:[insertorderedlist,insertunorderedlist]"},Indents:{img:11,"class":"Flyout",contains:"div.Flyout:[indent,outdent]"},div:{element:"div"},bold:{img:1,shortcut:"b",source:"<b>"},italic:{img:2,shortcut:"i",source:"<i>"},underline:{img:3,shortcut:"u",source:"<u>"},strikethrough:{img:4},justifyleft:{img:6,title:"Justify Left",onUpdate:function(b,c){var a=MooRTE.activeField.retrieve("bar").getElement(".rtejustify"+(c=="justify"?"full":c));if(a!==null){var d=a.addClass("rteSelected").getStyle("background-position");a.getParent().getParent().setStyle("background-position",d)}}},justifyfull:{img:7,title:"Justify Full"},justifycenter:{img:8,title:"Justify Center"},justifyright:{img:9,title:"Justify Right"},subscript:{img:18},superscript:{img:17},outdent:{img:11},indent:{img:12},insertorderedlist:{img:14,title:"Numbered List"},insertunorderedlist:{img:15,title:"Bulleted List"},selectall:{img:25,title:"Select All (Ctrl + A)"},removeformat:{img:26,title:"Clear Formatting"},undo:{img:31,title:"Undo (Ctrl + Z)"},redo:{img:32,title:"Redo (Ctrl+Y)"},inserthorizontalrule:{img:56,title:"Insert Horizontal Line"},cut:{img:20,title:"Cut (Ctrl+X)",onLoad:MooRTE.Utilities.clipStickyWin,onClick:function(a){Browser.firefox?MooRTE.Elements.clipPop.show():MooRTE.Utilities.exec(a)}},copy:{img:21,title:"Copy (Ctrl+C)",onLoad:MooRTE.Utilities.clipStickyWin,onClick:function(a){Browser.firefox?MooRTE.Elements.clipPop.show():MooRTE.Utilities.exec(a)}},paste:{img:22,title:"Paste (Ctrl+V)",onLoad:MooRTE.Utilities.clipStickyWin,onClick:function(a){Browser.firefox||Browser.webkit?MooRTE.Elements.clipPop.show():MooRTE.Utilities.exec(a)}},save:{img:27,src:"http://siteroller.net/test/save.php",onClick:function(){var b={page:window.location.pathname},a=0;b.content=[];this.getParent(".MooRTE").retrieve("fields").each(function(c){b.content[a++]=MooRTE.Utilities.clean(c)});new Request({url:MooRTE.Elements.save.src,onComplete:function(c){alert("Your submission has been received:\n\n"+c)}}).send(Object.toQueryString(b))}},"Html/Text":{img:"26",onClick:["DisplayHTML"]},DisplayHTML:{element:"textarea",unselectable:"off","class":"displayHtml",init:function(){var b=this.getParent(".MooRTE").retrieve("fields"),c=b.getParent(),a=(c.hasClass("rteTextArea")?c:b).getSize();this.set({styles:{width:a.x,height:a.y},text:b.innerHTML.trim()})}},colorpicker:{element:"img",src:"images/colorPicker.jpg","class":"colorPicker",onClick:function(){var g,f=this.getSize().x/2,l=mouse.x-f,j=mouse.y-f,k=e.y/e.getSize().y,e=Math.atan2(l,j)/Math.PI*3+1,d=Math.sqrt(l*l+j*j)/f;for(var b=0;b<3;b++){g[b]=(((Math.abs((e+=2)%6-3)<1?1:h>2?0:-(h-2))-k)*d+k)*255}var a=[g[0],g[2],g[1]].rgbToHex()}},hyperlink:{img:46,title:"Create hyperlink",onClick:function(){MooRTE.Range.create();$("popTXT").set("value",MooRTE.Range.get("text",MooRTE.ranges.a1));MooRTE.Elements.linkPop.show()},onLoad:function(){if(window.Asset){new Asset.javascript("StickyWinModalUI.js",{self:this,onComplete:function(){var a="<span style='display:inline-block; width:100px'>Text of Link:</span><input id='popTXT'/><br/>												<span style='display:inline-block; width:100px'>Link To Location:</span><input id='popURL'/><br/>												<input type='radio' name='pURL'  value='web' checked/>Web<input type='radio' name='pURL' id='pURL1' value='email'/>Email",b=[{text:"cancel"},{text:"OK",onClick:function(){MooRTE.Range.set();var c=$("popURL").get("value");if($("pURL1").get("checked")){c="mailto:"+c}MooRTE.Utilities.exec(c?"createlink":"unlink",c)}}];MooRTE.Elements.linkPop=new StickyWin.Modal({content:StickyWin.ui("Edit Link",a,{buttons:b})});MooRTE.Elements.linkPop.hide()}})}}},mooupload:{img:49,id:"imgUploader",title:"Upload Images",onLoad:function(){new Asset.javascript(MooRTE.Path+"mooupload/Source/MooUpload.js",{onComplete:function(){var a=new MooUpload(this,{action:MooRTE.Path+"filemanager/upload.php",flash:{movie:MooRTE.Path+"mooupload/Source/Moo.Uploader.swf"},autostart:true,accept:"image/*",verbose:true,texts:{selectfile:"&nbsp;"},onButtonDown:function(){MooRTE.Range.set()},onButtonEnter:function(){MooRTE.Range.create()},onFileUpload:function(b,c){var d=MooRTE.Path+"mooupload/Demo/tmp/"+c.upload_name;MooRTE.Range.set();MooRTE.Utilities.exec("insertimage",d)}})}.bind(this)})}},blockquote:{img:59,onClick:function(){MooRTE.Range.wrap("blockquote")}},start:{element:"span"},viewSource:{img:35,onClick:"source",source:function(b){var d=MooRTE.activeBar,c=d.retrieve("fields")[0],a=d.getElement("textarea.rtesource");if(this.hasClass("rteSelected")){d.eliminate("source");this.removeClass("rteSelected");if(c.contains(c.retrieve("bar"))){c.moorte("remove")}c.set("html",a.addClass("rteHide").get("value")).moorte()}else{d.store("source","source");if(a){this.addClass("rteSelected");a.removeClass("rteHide").set("text",MooRTE.Utilities.clean(d.retrieve("fields")[0]))}else{MooRTE.Utilities.group.apply(this,["source",b])}}}},source:{element:"textarea","class":"displayHtml",unselectable:"off",onLoad:function(){var d=this.getParent(".MooRTE"),b=d.retrieve("fields")[0],a=b.getSize(),c=d.getSize().y;this.set({styles:{width:a.x,height:a.y-c,top:c},text:MooRTE.Utilities.clean(b)})}},input:{img:59,onClick:function(){MooRTE.Range.insert("<input>")}},submit:{img:59,onClick:function(){MooRTE.Range.insert('<input type="submit" value="Submit">')}},cleanWord:{onClick:function(){var b=this.replace(/\r/g,"\n").replace(/\n/g," ");var a=[/<!--.+?-->/g,/<title>.+?<\/title>/g,/<(meta|link|.?o:|.?style|.?div|.?head|.?html|body|.?body|.?span|!\[)[^>]*?>/g,/ v:.*?=".*?"/g,/ style=".*?"/g,/ class=".*?"/g,/(&nbsp;){2,}/g,/<p>(\s|&nbsp;)*?<\/p>/g];a.each(function(c){b=b.replace(c,"")});return b.replace(/\s+/g," ")}},decreasefontsize:{img:42,onClick:function(){if(!Browser.firefox){return MooRTE.Utilities.fontsize.pass(-1)}}()},increasefontsize:{img:41,onClick:function(){if(!Browser.firefox){return MooRTE.Utilities.fontsize.pass(1)}}()},fontsize:{},insertimage:{},forecolor:{},formatblock:{},backcolor:{img:43,onLoad:function(){MooRTE.Utilities.assetLoader({scripts:["/siteroller/classes/colorpicker/Source/ColorRoller.js"],styles:["/siteroller/classes/colorpicker/Source/ColorRoller.js"],onComplete:function(){}})},onClick:function(){var a=(Browser.Engine.gecko?"hilitecolor":"backcolor")}},Toolbar:{element:"div"}};